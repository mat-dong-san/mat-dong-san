<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="memberMapper">
	<select id="memberLogin" resultMap="memberResultSet">
		select *
		from member
		where US_ID=#{us_id}
				and US_DEL_YN='N'
	</select>
	
	<resultMap type="Member" id="memberResultSet">
		<id column="US_ID" property="us_id"/>
		<result column="US_PWD" property="us_pwd"/>
		<result column="US_NAME" property="us_name"/>
		<result column="US_SSN" property="us_ssn"/>
		<result column="US_PHONE" property="us_phone"/>
		<result column="US_EMAIL" property="us_email"/>
		<result column="US_ADDR" property="us_addr"/>
		<result column="US_PICTURE" property="us_picture"/>
		<result column="US_TYPE" property="us_type"/>
		<result column="US_REG_D" property="us_reg_d"/>
		<result column="US_KAKAO" property="us_kakao"/>
		<result column="US_DEL_YN" property="us_del_yn"/>
	</resultMap>

	
	<insert id="insertMember" parameterType="Member">
		insert into member
		values(#{us_id}, #{us_pwd}, #{us_name}, #{us_ssn}, #{us_phone}, #{us_email},
		#{us_addr}, #{us_picture}, #{us_type}, sysdate, default, default)
	</insert>
	
	<select id="checkIdDup" resultType="_int">
		select count(*)
		from member
		where US_ID=#{us_id}
	</select>
	
	<select id="checkIdDup2" resultType="_int">
		select count(*)
		from member
		where US_ID=#{us_id} and US_TYPE= '중개사'
	</select>
	
	<select id="checkNameDup" resultType="_int">
		select count(*)
		from estateagent
		where E_NAME=#{e_name}
	</select>

	<insert id="insertEstateAgent" parameterType="EstateAgent">
		insert into estateagent
		values(seq_e_id.nextval, #{e_name}, #{e_phone}, #{e_content}, #{e_addr}, #{e_picture}, #{e_field},
		#{e_reg_num}, default, default, default, default, sysdate, default, #{us_id})
	</insert>
	
	<!-- 중개사추가////////////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
	
	<resultMap type="EstateAgent" id="estateAgentResultSet">
		<id column="E_ID" property="us_id"/>
		<result column="E_NAME" property="e_name"/>
		<result column="E_PHONE" property="e_phone"/>
		<result column="E_CONTENT" property="e_content"/>
		<result column="E_ADDR" property="e_addr"/>
		<result column="E_PICTURE" property="e_picture"/>
		<result column="E_FIELD" property="e_field"/>
		<result column="E_COORD" property="e_coord"/>
		<result column="E_C_LAT" property="e_c_lat"/>
		<result column="E_C_LNG" property="e_c_lng"/>
		<result column="E_POINT" property="e_point"/>
		<result column="E_REG_D" property="e_reg_d"/>
		<result column="E_DEL_YN" property="e_del_yn"/>
		<result column="US_ID" property="us_id"/>
	</resultMap>
	
	<select id="selectEstateAgentInfo" resultMap="estateAgentResultSet">
		select *
		from estateagent
		where US_ID=#{us_id}
		and E_DEL_YN='N'
	</select>
	
	<update id="updateEstateAgent">
		update estateagent
		set e_name=#{e_name}, e_phone=#{e_phone}, e_content=#{e_content}, e_addr=#{e_addr},
		e_picture=#{e_picture}, e_field=#{e_field}, e_reg_num=#{e_reg_num}
		where us_id=#{us_id}
	</update>
	

</mapper>
